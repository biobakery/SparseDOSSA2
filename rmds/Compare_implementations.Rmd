---
title: "Compare implementations"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = "/n/janson_lab/lab/sma/sparsedossa_update/")
knitr::opts_chunk$set(echo=FALSE)
library(magrittr)
library(ggplot2)
```

# An error in estimation of $\rho_{ij}$

* Previously, esitmate the feature-feature correlation $\rho_{ij}$ with 
  (penalized) method of moment estimator, where $\hat{\rho}_{ij}$ is matched to 
  $\rho^s_{ij}$, the sample spearman correlation.

* Motivation: $g_i \rightarrow a_i$ monotonically, so spearman correlation on $a$
  is the same as spearman correlation on $g$
  
* However, not completely true, as smaller $g$'s gets mapped to the zero spike 
  in $a$
  
* Instead, propose alternative MM parameter: $\rho^*_{ij} = \text{cor}(g_i^*, g_j^*)$,
  where $g_i^*$ is the same as $g_i$, but with those in the zero-spike region being
  replaced by some constant (can be fixed by ensuring $E g_i^* = 0$).
  
* $\rho^*_{ij}$ is a monotonic function of $\rho$; it also has an easy sample estimator,
  making MM estimation straightforward.
  
```{r compare results}
smar::sourceDir("SparseDOSSA2/R/")
load("results/Simulation_smaller2/46/debug_lambda_1.RData")
```